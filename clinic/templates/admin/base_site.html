{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}{{ title }} | Romualdez Skin Clinic Staff Portal{% endblock %}

{% block branding %}
<div style="display: flex; align-items: center; padding: 15px 25px;">
    <div style="margin-right: 20px;">
        <i class="fas fa-clinic-medical" style="font-size: 2.5em; color: white;"></i>
    </div>
    <div>
        <h1 style="margin: 0; color: white; font-size: 1.8em; font-weight: 600;">Romualdez Skin Clinic</h1>
        <p style="margin: 0; color: rgba(255,255,255,0.9); font-size: 0.95em; margin-top: 2px;">Staff Portal Dashboard</p>
    </div>
</div>
{% endblock %}

{% block nav-global %}{% endblock %}

{% block extrastyle %}
{{ block.super }}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="{% static 'css/main.css' %}">
<link rel="stylesheet" href="{% static 'css/admin_overrides.css' %}">
<link rel="stylesheet" href="{% static 'css/admin_forms.css' %}">
<link rel="stylesheet" href="{% static 'css/inventory.css' %}">
{% endblock %}

{% block extrahead %}
{{ block.super }}
<script>
// Remove "Bookings" from breadcrumbs and fix sidebar text display
document.addEventListener('DOMContentLoaded', function() {
    // Fix breadcrumbs - remove "Bookings" app label
    const breadcrumbs = document.querySelector('.breadcrumbs');
    if (breadcrumbs) {
        let breadcrumbHTML = breadcrumbs.innerHTML;
        
        // Remove "Bookings ›" and just "Bookings"
        breadcrumbHTML = breadcrumbHTML.replace(/>\s*Bookings\s*›\s*/g, '> ');
        breadcrumbHTML = breadcrumbHTML.replace(/>\s*Bookings\s*</g, '><');
        
        // Clean up multiple consecutive separators
        breadcrumbHTML = breadcrumbHTML.replace(/›\s*›/g, '›');
        
        breadcrumbs.innerHTML = breadcrumbHTML;
    }
    
    // Ensure sidebar links display properly (not vertically stacked)
    const sidebarLinks = document.querySelectorAll('#nav-sidebar a');
    sidebarLinks.forEach(link => {
        // Force proper text display
        link.style.display = 'block';
        link.style.whiteSpace = 'normal';
        link.style.wordWrap = 'break-word';
        link.style.overflowWrap = 'break-word';
        link.style.lineHeight = '1.4';
        link.style.minHeight = 'auto';
    });
    
    // Fix any vertically stacked text in sidebar
    const sidebarElements = document.querySelectorAll('#nav-sidebar h2, #nav-sidebar caption, #nav-sidebar span');
    sidebarElements.forEach(element => {
        element.style.whiteSpace = 'normal';
        element.style.wordWrap = 'break-word';
        element.style.display = 'block';
    });
});
</script>

<style>
    /* ===== IMPORT MAIN TEMPLATE VARIABLES ===== */
    /* ===== IMPORT MAIN TEMPLATE VARIABLES ===== */
    :root {
        /* Primary Colors (from main.css) */
        --primary-color: #3d5c3d;
        --primary-dark: #2e472e;
        --primary-light: #5a7c5a;
        --secondary-color: #f8f9fa;
        --accent-color: #e9ecef;
        
        /* Text Colors */
        --text-dark: #333;
        --text-light: #666;
        --text-muted: #999;
        --background-color: #edeae3;
        --white: #ffffff;
        
        /* Status Colors */
        --success: #28a745;
        --warning: #ffc107;
        --error: #dc3545;
        --info: #17a2b8;
        
        /* Spacing (from main.css) */
        --spacing-xs: 0.25rem;
        --spacing-sm: 0.5rem;
        --spacing-md: 1rem;
        --spacing-lg: 1.5rem;
        --spacing-xl: 2rem;
        --spacing-xxl: 3rem;
        
        /* Borders */
        --border-radius: 8px;
        --border-radius-sm: 4px;
        --border-radius-lg: 12px;
        
        /* Shadows (from main.css) */
        --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
        --shadow-md: 0 2px 8px rgba(0,0,0,0.1);
        --shadow-lg: 0 4px 16px rgba(0,0,0,0.15);
        
        /* Transitions */
        --transition-fast: 0.2s ease;
        --transition-normal: 0.3s ease;
        --transition-slow: 0.5s ease;
        
        /* Admin compatibility aliases */
        --primary: var(--primary-color);
        --secondary: var(--primary-dark);
        --accent: var(--primary-light);
        --light-bg: var(--secondary-color);
        --border: var(--accent-color);
    }

    /* ===== GLOBAL BODY & TYPOGRAPHY ===== */
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
        background: var(--background-color) !important;
        color: var(--text-dark) !important;
        line-height: 1.6 !important;
    }

    /* ===== HEADER & NAVIGATION ===== */
    #header {
        background: var(--primary-color) !important;
        color: var(--white) !important;
        box-shadow: var(--shadow-md) !important;
        position: sticky !important;
        top: 0 !important;
        z-index: 100 !important;
    }

    #branding h1, 
    #branding h1 a:link, 
    #branding h1 a:visited {
        color: var(--white) !important;
        font-weight: 600 !important;
    }

    /* Hide any default Django user-tools that might appear */
    #header #user-tools:not(:last-of-type) {
        display: none !important;
    }

    #user-tools {
        padding: 15px 20px !important;
        color: var(--white) !important;
        font-size: 0.95rem !important; /* Smaller font size */
    }

    /* Hide change password link */
    #user-tools a[href*="password_change"] {
        display: none !important;
    }

    /* Style welcome text - make it 3px bigger than base */
    #user-tools strong {
        color: var(--white) !important;
        font-weight: normal !important;
        margin-right: var(--spacing-sm) !important;
        font-size: calc(1em + 3px) !important;
    }

    /* Make View site link look like a button */
    #user-tools a:link,
    #user-tools a:visited {
        background: var(--white) !important;
        color: var(--primary-color) !important;
        text-decoration: none !important;
        padding: var(--spacing-sm) var(--spacing-md) !important;
        border-radius: var(--border-radius-sm) !important;
        transition: var(--transition-fast) !important;
        font-weight: normal !important;
        border: none !important;
        font-size: 1em !important;
    }

    #user-tools a:hover {
        background: rgba(255,255,255,0.9) !important;
        color: var(--primary-dark) !important;
    }

    /* Revert logout button to original Django style */
    #user-tools form {
        display: inline !important;
        margin: 0 !important;
        padding: 0 !important;
        width: auto !important;
    }

    #user-tools button[type="submit"],
    #user-tools input[type="submit"] {
        background: var(--white) !important;
        color: var(--primary-color) !important;
        border: none !important;
        padding: var(--spacing-sm) var(--spacing-md) !important;
        border-radius: var(--border-radius-sm) !important;
        cursor: pointer !important;
        font-size: 1em !important;
        font-family: inherit !important;
        font-weight: normal !important;
        box-shadow: none !important;
        transition: var(--transition-fast) !important;
        text-decoration: none !important;
        display: inline !important;
        width: auto !important;
        margin: 0 !important;
        vertical-align: baseline !important;
    }

    #user-tools button[type="submit"]:hover,
    #user-tools input[type="submit"]:hover {
        background: rgba(255,255,255,0.9) !important;
        color: var(--primary-dark) !important;
        transform: none !important;
        box-shadow: none !important;
    }

    /* ===== MAIN CONTENT AREA ===== */
    #content {
        padding: var(--spacing-xl) var(--spacing-md) !important;
        max-width: 1400px !important;
        margin: 0 auto !important;
    }

    #content-main {
        background: transparent !important;
    }

    /* ===== BREADCRUMBS ===== */
    .breadcrumbs {
        background: var(--white) !important;
        padding: var(--spacing-md) var(--spacing-lg) !important;
        border-radius: var(--border-radius) !important;
        box-shadow: var(--shadow-sm) !important;
        margin-bottom: var(--spacing-lg) !important;
    }

    .breadcrumbs a:link,
    .breadcrumbs a:visited {
        color: var(--primary-color) !important;
        text-decoration: none !important;
        font-weight: 500 !important;
    }

    .breadcrumbs a:hover {
        color: var(--primary-dark) !important;
        text-decoration: underline !important;
    }

    /* ===== MODULES & CARDS ===== */
    .module,
    .dashboard .module {
        background: var(--white) !important;
        border-radius: var(--border-radius-lg) !important;
        padding: 0 !important;
        box-shadow: var(--shadow-md) !important;
        margin-bottom: var(--spacing-xl) !important;
        overflow: hidden !important;
        border: none !important;
    }

    .module h2,
    .module caption,
    .inline-group h2,
    .dashboard .module h2 {
        background: var(--primary-color) !important;
        color: var(--white) !important;
        padding: var(--spacing-lg) var(--spacing-xl) !important;
        font-size: 1.2em !important;
        font-weight: 600 !important;
        margin: 0 !important;
        border-radius: 0 !important;
    }
    
    /* Fieldset legends should not have background */
    fieldset h2,
    .collapse h2,
    fieldset legend {
        background: transparent !important;
        color: var(--text-dark) !important;
        padding: var(--spacing-sm) 0 !important;
        font-size: 1em !important;
        border-bottom: 2px solid var(--accent-color) !important;
    }
    
    /* Inline table headers */
    .inline-related h3,
    .inline-group h3,
    table caption {
        background: var(--primary-color) !important;
        color: var(--white) !important;
        padding: var(--spacing-md) var(--spacing-lg) !important;
        font-size: 1em !important;
        font-weight: 600 !important;
    }

    .module table,
    .dashboard .module table {
        margin: 0 !important;
        border-collapse: collapse !important;
    }

    .module table th {
        background: var(--secondary-color) !important;
        color: var(--text-dark) !important;
        font-weight: 600 !important;
        padding: var(--spacing-md) var(--spacing-lg) !important;
        border-bottom: 2px solid var(--accent-color) !important;
    }

    .module table td {
        padding: var(--spacing-md) var(--spacing-lg) !important;
        border-bottom: 1px solid var(--accent-color) !important;
    }

    .module table tr:hover {
        background: var(--secondary-color) !important;
    }
    
    /* Fix inline tables (like Sale Items) */
    .inline-related table,
    .inline-group table,
    table.inline {
        width: 100% !important;
        table-layout: auto !important;
    }
    
    .inline-related td,
    .inline-group td,
    table.inline td {
        vertical-align: top !important;
        padding: 8px !important;
    }
    
    .inline-related th,
    .inline-group th,
    table.inline th {
        text-align: left !important;
        white-space: nowrap !important;
        padding: 8px !important;
    }
    
    /* Inline form fields */
    .inline-related input[type="text"],
    .inline-related input[type="number"],
    .inline-related select,
    .inline-group input[type="text"],
    .inline-group input[type="number"],
    .inline-group select {
        min-width: 100px !important;
        max-width: 200px !important;
    }

    /* ===== BUTTONS (matching main.css) ===== */
    .button,
    input[type=submit],
    input[type=button],
    .submit-row input,
    a.button,
    button {
        display: inline-flex !important;
        align-items: center !important;
        gap: var(--spacing-sm) !important;
        background: var(--primary-color) !important;
        color: var(--white) !important;
        border: none !important;
        border-radius: var(--border-radius) !important;
        padding: var(--spacing-md) var(--spacing-xl) !important;
        font-weight: 500 !important;
        text-decoration: none !important;
        cursor: pointer !important;
        transition: var(--transition-fast) !important;
        font-size: 0.95rem !important;
        box-shadow: var(--shadow-sm) !important;
    }

    .button:hover,
    input[type=submit]:hover,
    input[type=button]:hover,
    .submit-row input:hover,
    a.button:hover,
    button:hover {
        background: var(--primary-dark) !important;
        transform: translateY(-2px) !important;
        box-shadow: var(--shadow-md) !important;
    }

    .button.default,
    input[type=submit].default {
        background: var(--primary-color) !important;
    }

    /* Cancel/Delete buttons */
    .button.cancel-link,
    .deletelink {
        background: transparent !important;
        color: var(--error) !important;
        border: 2px solid var(--error) !important;
    }

    .button.cancel-link:hover,
    .deletelink:hover {
        background: var(--error) !important;
        color: var(--white) !important;
    }

    /* ===== FORMS (matching main.css) ===== */
    .form-row {
        padding: var(--spacing-lg) 0 !important;
        border-bottom: 1px solid var(--accent-color) !important;
    }

    .form-row label {
        font-weight: 500 !important;
        color: var(--text-dark) !important;
        margin-bottom: var(--spacing-sm) !important;
    }

    input[type=text],
    input[type=password],
    input[type=email],
    input[type=url],
    input[type=number],
    input[type=date],
    input[type=time],
    input[type=datetime-local],
    textarea,
    select {
        width: 100% !important;
        padding: var(--spacing-md) !important;
        border: 2px solid var(--accent-color) !important;
        border-radius: var(--border-radius) !important;
        font-size: 1rem !important;
        transition: var(--transition-fast) !important;
        background: var(--white) !important;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
    }

    input:focus,
    textarea:focus,
    select:focus {
        outline: none !important;
        border-color: var(--primary-color) !important;
        box-shadow: 0 0 0 3px rgba(61, 92, 61, 0.1) !important;
    }

    /* ===== CHANGE LISTS ===== */
    #changelist {
        background: var(--white) !important;
        border-radius: var(--border-radius-lg) !important;
        padding: var(--spacing-xl) !important;
        box-shadow: var(--shadow-md) !important;
    }

    #changelist-filter {
        background: var(--white) !important;
        border-radius: var(--border-radius) !important;
        border: 1px solid var(--accent-color) !important;
        padding: var(--spacing-lg) !important;
    }

    #changelist-filter h2 {
        color: var(--primary-color) !important;
        font-weight: 600 !important;
    }

    #changelist-filter h3 {
        color: var(--text-dark) !important;
        font-weight: 500 !important;
    }

    #changelist-filter li.selected a {
        color: var(--primary-color) !important;
        font-weight: 600 !important;
    }

    /* ===== STATS CARDS (from main.css + dashboard) ===== */
    .stats-container {
        display: grid !important;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
        gap: var(--spacing-xl) !important;
        margin-bottom: var(--spacing-xxl) !important;
    }

    .stat-card {
        background: var(--white) !important;
        border-radius: var(--border-radius-lg) !important;
        padding: var(--spacing-xl) !important;
        box-shadow: var(--shadow-md) !important;
        text-align: center !important;
        border-left: 4px solid var(--primary-color) !important;
        transition: var(--transition-fast) !important;
    }

    .stat-card:hover {
        transform: translateY(-5px) !important;
        box-shadow: var(--shadow-lg) !important;
    }

    .stat-card .stat-icon {
        font-size: 2.5em !important;
        color: var(--primary-light) !important;
        margin-bottom: var(--spacing-md) !important;
    }

    .stat-card .stat-number {
        font-size: 2.5em !important;
        font-weight: bold !important;
        color: var(--primary-color) !important;
        margin-bottom: var(--spacing-sm) !important;
    }

    .stat-card .stat-label {
        color: var(--text-light) !important;
        font-size: 0.95em !important;
        font-weight: 500 !important;
    }

    /* ===== QUICK ACTIONS (matching main.css cards) ===== */
    .quick-actions {
        background: var(--white) !important;
        border-radius: var(--border-radius-lg) !important;
        padding: var(--spacing-xxl) !important;
        box-shadow: var(--shadow-md) !important;
        margin-bottom: var(--spacing-xxl) !important;
    }

    .quick-actions h3 {
        color: var(--primary-color) !important;
        margin-top: 0 !important;
        margin-bottom: var(--spacing-lg) !important;
        font-size: 1.3em !important;
        font-weight: 600 !important;
        display: flex !important;
        align-items: center !important;
        gap: var(--spacing-sm) !important;
    }

    .action-buttons {
        display: grid !important;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)) !important;
        gap: var(--spacing-lg) !important;
    }

    .action-btn {
        display: flex !important;
        align-items: center !important;
        padding: var(--spacing-lg) !important;
        background: var(--secondary-color) !important;
        border: 1px solid var(--accent-color) !important;
        border-radius: var(--border-radius) !important;
        text-decoration: none !important;
        color: var(--primary-color) !important;
        transition: var(--transition-fast) !important;
        font-weight: 500 !important;
        gap: var(--spacing-md) !important;
    }

    .action-btn:hover {
        background: var(--primary-color) !important;
        color: var(--white) !important;
        transform: translateY(-2px) !important;
        box-shadow: var(--shadow-md) !important;
        border-color: var(--primary-color) !important;
    }

    .action-btn i {
        font-size: 1.3em !important;
    }

    /* ===== ALERTS & MESSAGES (from main.css) ===== */
    .messagelist,
    ul.messagelist {
        padding: 0 !important;
        margin: 0 0 var(--spacing-xl) 0 !important;
        list-style: none !important;
    }

    .messagelist li,
    ul.messagelist li {
        padding: var(--spacing-lg) var(--spacing-xl) !important;
        border-radius: var(--border-radius) !important;
        margin-bottom: var(--spacing-md) !important;
        display: flex !important;
        align-items: center !important;
        gap: var(--spacing-sm) !important;
        font-weight: 500 !important;
        box-shadow: var(--shadow-sm) !important;
    }

    .messagelist li.success,
    ul.messagelist li.success {
        background: #d4edda !important;
        color: #155724 !important;
        border: 1px solid #c3e6cb !important;
    }

    .messagelist li.error,
    ul.messagelist li.error {
        background: #f8d7da !important;
        color: #721c24 !important;
        border: 1px solid #f5c6cb !important;
    }

    .messagelist li.warning,
    ul.messagelist li.warning {
        background: #fff3cd !important;
        color: #856404 !important;
        border: 1px solid #ffeaa7 !important;
    }

    .messagelist li.info,
    ul.messagelist li.info {
        background: #d1ecf1 !important;
        color: #0c5460 !important;
        border: #bee5eb !important;
    }

    /* ===== PAGINATION ===== */
    .pagination {
        padding: var(--spacing-lg) 0 !important;
        display: flex !important;
        justify-content: center !important;
        gap: var(--spacing-sm) !important;
    }

    .pagination a,
    .pagination span {
        padding: var(--spacing-sm) var(--spacing-md) !important;
        border-radius: var(--border-radius-sm) !important;
        text-decoration: none !important;
        color: var(--primary-color) !important;
        font-weight: 500 !important;
        transition: var(--transition-fast) !important;
    }

    .pagination a:hover {
        background: var(--primary-color) !important;
        color: var(--white) !important;
    }

    .pagination .this-page {
        background: var(--primary-color) !important;
        color: var(--white) !important;
    }

    /* ===== RESPONSIVE DESIGN (from main.css) ===== */
    @media (max-width: 768px) {
        #content {
            padding: var(--spacing-md) var(--spacing-sm) !important;
        }
        
        .stats-container {
            grid-template-columns: 1fr 1fr !important;
            gap: var(--spacing-md) !important;
        }
        
        .action-buttons {
            grid-template-columns: 1fr !important;
        }
        
        .module,
        .quick-actions {
            padding: var(--spacing-lg) !important;
        }
    }

    @media (max-width: 480px) {
        .stats-container {
            grid-template-columns: 1fr !important;
        }
        
        .stat-card {
            padding: var(--spacing-lg) !important;
        }
    }

    /* ===== ANIMATIONS (from main.css) ===== */
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @keyframes slideUp {
        from { 
            opacity: 0;
            transform: translateY(30px);
        }
        to { 
            opacity: 1;
            transform: translateY(0);
        }
    }

    .fade-in {
        animation: fadeIn var(--transition-normal) !important;
    }

    .slide-up {
        animation: slideUp var(--transition-normal) !important;
    }

    /* ===== PERMISSION NOTICE STYLES ===== */
    .permission-notice {
        background: #e8f4f8 !important;
        border: 1px solid #bee5eb !important;
        border-radius: var(--border-radius) !important;
        padding: var(--spacing-lg) !important;
        margin: 0 0 var(--spacing-xl) 0 !important;
        color: #0c5460 !important;
        display: flex !important;
        align-items: center !important;
        gap: var(--spacing-md) !important;
        font-weight: 500 !important;
        box-shadow: var(--shadow-sm) !important;
    }

    .permission-notice i {
        font-size: 1.5em !important;
    }

    .permission-notice.staff {
        background: #fff3cd !important;
        border-color: #ffeaa7 !important;
        color: #856404 !important;
    }

    .permission-notice.superuser {
        background: #d1ecf1 !important;
        border-color: #b6d4da !important;
        color: #0c5460 !important;
    }

    /* ===== INVENTORY SPECIFIC STYLES ===== */
    .stat-card.stat-warning {
        background: #fff3cd !important;
        border-left: 4px solid var(--warning) !important;
    }

    .stat-card.stat-warning .stat-icon {
        background: var(--warning) !important;
    }

    .stat-card.stat-danger {
        background: #f8d7da !important;
        border-left: 4px solid var(--error) !important;
    }

    .stat-card.stat-danger .stat-icon {
        background: var(--error) !important;
    }

    /* ===== SIDEBAR NAVIGATION ===== */
    #nav-sidebar {
        background: var(--white) !important;
        border-radius: var(--border-radius) !important;
        box-shadow: var(--shadow-sm) !important;
        min-width: 200px !important;
        max-width: 200px !important;
        width: 200px !important;
    }

    #nav-sidebar a {
        color: var(--text-dark) !important;
        padding: 8px 12px !important;
        border-radius: var(--border-radius-sm) !important;
        transition: var(--transition-fast) !important;
        display: block !important;
        white-space: normal !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
        text-overflow: clip !important;
        line-height: 1.3 !important;
        font-size: 13px !important;
    }

    #nav-sidebar a:hover,
    #nav-sidebar a.current {
        background: var(--primary-color) !important;
        color: var(--white) !important;
    }
    
    /* Ensure sidebar list items don't stack vertically */
    #nav-sidebar ul {
        list-style: none !important;
        padding: 0 !important;
        margin: 0 !important;
    }
    
    #nav-sidebar li {
        margin: 0 !important;
        padding: 0 !important;
    }
    
    /* Section headers in sidebar */
    #nav-sidebar h2,
    #nav-sidebar caption {
        padding: 8px 12px !important;
        font-weight: 600 !important;
        color: var(--primary-color) !important;
        font-size: 0.75em !important;
        text-transform: uppercase !important;
        letter-spacing: 0.5px !important;
        margin: 8px 0 4px 0 !important;
        white-space: normal !important;
        word-wrap: break-word !important;
    }

    /* ===== ACCESSIBILITY (from main.css) ===== */
    *:focus {
        outline: 2px solid var(--primary-color) !important;
        outline-offset: 2px !important;
    }

    /* ===== LOADING STATES ===== */
    .loading {
        position: relative !important;
        overflow: hidden !important;
    }

    .loading::after {
        content: '' !important;
        position: absolute !important;
        top: 0 !important;
        left: -100% !important;
        width: 100% !important;
        height: 100% !important;
        background: linear-gradient(
            90deg,
            transparent,
            rgba(255,255,255,0.4),
            transparent
        ) !important;
        animation: loading 1.5s infinite !important;
    }

    @keyframes loading {
        to {
            left: 100% !important;
        }
    }
</style>
{% endblock %}